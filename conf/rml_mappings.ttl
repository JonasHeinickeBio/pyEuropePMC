@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix bibo: <http://purl.org/ontology/bibo/> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix nif: <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#> .
@prefix ex: <http://example.org/> .
@prefix data: <http://example.org/data/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix datacite: <http://purl.org/spar/datacite/> .
@prefix geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> .
@prefix org: <http://www.w3.org/ns/org#> .
@prefix ror: <https://ror.org/vocab#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .

# RML Mappings for PyEuropePMC Data Models
# These mappings convert JSON representations of entities to RDF
# TODO: URI templates here use simple patterns, but RDFMapper uses dynamic URIs (DOI-based for papers, etc.)
# TODO: Keep synchronized with rdf_map.yml - consider auto-generation script

# ===== PaperEntity Mapping =====
<#PaperEntityMap>
    rml:logicalSource [
        rml:source "paper.json" ;
        rml:referenceFormulation ql:JSONPath ;
        rml:iterator "$[*]"
    ] ;

    rr:subjectMap [
        rr:template "http://example.org/data/paper/{pmcid}" ;
        rr:class bibo:AcademicArticle
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:identifier ;
        rr:objectMap [ rml:reference "pmcid" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate bibo:doi ;
        rr:objectMap [ rml:reference "doi" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:title ;
        rr:objectMap [ rml:reference "title" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate bibo:journal ;
        rr:objectMap [ rml:reference "journal" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate bibo:volume ;
        rr:objectMap [ rml:reference "volume" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate bibo:issue ;
        rr:objectMap [ rml:reference "issue" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate bibo:pages ;
        rr:objectMap [ rml:reference "pages" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:issued ;
        rr:objectMap [ rml:reference "pub_date" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:date ;
        rr:objectMap [ rml:reference "publication_date" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:date ;
        rr:objectMap [ rml:reference "publication_year" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:abstract ;
        rr:objectMap [ rml:reference "abstract" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:citationCount ;
        rr:objectMap [ rml:reference "citation_count" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:influentialCitationCount ;
        rr:objectMap [ rml:reference "influential_citation_count" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:isOpenAccess ;
        rr:objectMap [ rml:reference "is_oa" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:openAccessStatus ;
        rr:objectMap [ rml:reference "oa_status" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:openAccessUrl ;
        rr:objectMap [ rml:reference "oa_url" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label ;
        rr:objectMap [ rml:reference "label" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate prov:wasDerivedFrom ;
        rr:objectMap [ rml:reference "source_uri" ; rr:termType rr:IRI ]
    ] ;

    # Multi-value field: keywords
    rr:predicateObjectMap [
        rr:predicate dct:subject ;
        rr:objectMap [ rml:reference "keywords[*]" ]
    ] ;

    # Multi-value field: fields_of_study
    rr:predicateObjectMap [
        rr:predicate dct:subject ;
        rr:objectMap [ rml:reference "fields_of_study[*]" ]
    ] .

# ===== AuthorEntity Mapping =====
<#AuthorEntityMap>
    rml:logicalSource [
        rml:source "authors.json" ;
        rml:referenceFormulation ql:JSONPath ;
        rml:iterator "$[*]"
    ] ;

    rr:subjectMap [
        rr:template "http://example.org/data/author/{id}" ;
        rr:class foaf:Person
    ] ;

    rr:predicateObjectMap [
        rr:predicate foaf:name ;
        rr:objectMap [ rml:reference "full_name" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate foaf:name ;
        rr:objectMap [ rml:reference "name" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate foaf:givenName ;
        rr:objectMap [ rml:reference "first_name" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate foaf:familyName ;
        rr:objectMap [ rml:reference "last_name" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate foaf:initials ;
        rr:objectMap [ rml:reference "initials" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate datacite:orcid ;
        rr:objectMap [ rml:reference "orcid" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:openAlexId ;
        rr:objectMap [ rml:reference "openalex_id" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:affiliation ;
        rr:objectMap [ rml:reference "affiliation_text" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:authorPosition ;
        rr:objectMap [ rml:reference "position" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate foaf:mbox ;
        rr:objectMap [ rml:reference "email" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label ;
        rr:objectMap [ rml:reference "label" ]
    ] .

# ===== SectionEntity Mapping =====
<#SectionEntityMap>
    rml:logicalSource [
        rml:source "sections.json" ;
        rml:referenceFormulation ql:JSONPath ;
        rml:iterator "$[*]"
    ] ;

    rr:subjectMap [
        rr:template "http://example.org/data/section/{id}" ;
        rr:class bibo:DocumentPart, nif:Context
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:title ;
        rr:objectMap [ rml:reference "title" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate nif:isString ;
        rr:objectMap [ rml:reference "content" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate nif:beginIndex ;
        rr:objectMap [ rml:reference "begin_index" ; rr:datatype xsd:integer ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate nif:endIndex ;
        rr:objectMap [ rml:reference "end_index" ; rr:datatype xsd:integer ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label ;
        rr:objectMap [ rml:reference "label" ]
    ] .

# ===== TableEntity Mapping =====
<#TableEntityMap>
    rml:logicalSource [
        rml:source "tables.json" ;
        rml:referenceFormulation ql:JSONPath ;
        rml:iterator "$[*]"
    ] ;

    rr:subjectMap [
        rr:template "http://example.org/data/table/{id}" ;
        rr:class bibo:Table
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:description ;
        rr:objectMap [ rml:reference "caption" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label ;
        rr:objectMap [ rml:reference "table_label" ]
    ] .

# ===== ReferenceEntity Mapping =====
<#ReferenceEntityMap>
    rml:logicalSource [
        rml:source "references.json" ;
        rml:referenceFormulation ql:JSONPath ;
        rml:iterator "$[*]"
    ] ;

    rr:subjectMap [
        rr:template "http://example.org/data/reference/{id}" ;
        rr:class bibo:Document
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:title ;
        rr:objectMap [ rml:reference "title" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:isPartOf ;
        rr:objectMap [ rml:reference "source" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:issued ;
        rr:objectMap [ rml:reference "year" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate bibo:volume ;
        rr:objectMap [ rml:reference "volume" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate bibo:pages ;
        rr:objectMap [ rml:reference "pages" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate bibo:doi ;
        rr:objectMap [ rml:reference "doi" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate dct:creator ;
        rr:objectMap [ rml:reference "authors[*]" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label ;
        rr:objectMap [ rml:reference "label" ]
    ] .

# ===== InstitutionEntity Mapping =====
<#InstitutionEntityMap>
    rml:logicalSource [
        rml:source "institutions.json" ;
        rml:referenceFormulation ql:JSONPath ;
        rml:iterator "$[*]"
    ] ;

    rr:subjectMap [
        rr:template "http://example.org/data/institution/{id}" ;
        rr:class org:Organization
    ] ;

    rr:predicateObjectMap [
        rr:predicate skos:prefLabel ;
        rr:objectMap [ rml:reference "display_name" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ror:rorId ;
        rr:objectMap [ rml:reference "ror_id" ; rr:termType rr:IRI ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:openAlexId ;
        rr:objectMap [ rml:reference "openalex_id" ; rr:termType rr:IRI ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:country ;
        rr:objectMap [ rml:reference "country" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:countryCode ;
        rr:objectMap [ rml:reference "country_code" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:city ;
        rr:objectMap [ rml:reference "city" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate geo:lat ;
        rr:objectMap [ rml:reference "latitude" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate geo:long ;
        rr:objectMap [ rml:reference "longitude" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate org:classification ;
        rr:objectMap [ rml:reference "institution_type" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:gridId ;
        rr:objectMap [ rml:reference "grid_id" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:isni ;
        rr:objectMap [ rml:reference "isni" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:wikidataId ;
        rr:objectMap [ rml:reference "wikidata_id" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:fundrefId ;
        rr:objectMap [ rml:reference "fundref_id" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate foaf:homepage ;
        rr:objectMap [ rml:reference "website" ; rr:termType rr:IRI ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate ex:establishedYear ;
        rr:objectMap [ rml:reference "established" ]
    ] ;

    rr:predicateObjectMap [
        rr:predicate rdfs:label ;
        rr:objectMap [ rml:reference "label" ]
    ] ;

    # Multi-value field: domains
    rr:predicateObjectMap [
        rr:predicate ex:domain ;
        rr:objectMap [ rml:reference "domains[*]" ]
    ] .
