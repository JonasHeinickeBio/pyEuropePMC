# RDF Mapping Configuration for PyEuropePMC Data Models
#
# This file is the SOURCE OF TRUTH for all RDF mappings.
# The RML file (rml_mappings.ttl) is auto-generated from this YAML.
#
# After editing this file, run: python scripts/sync_rdf_mappings.py
#
# This file defines how entity fields map to RDF predicates.
# URI generation patterns are handled dynamically in RDFMapper._generate_entity_uri()
# (DOI-based for papers, ORCID-based for authors, ROR-based for institutions, etc.)

# Namespace prefixes
_@prefix:
  dcterms: "http://purl.org/dc/terms/"
  foaf: "http://xmlns.com/foaf/0.1/"
  bibo: "http://purl.org/ontology/bibo/"
  prov: "http://www.w3.org/ns/prov#"
  rdfs: "http://www.w3.org/2000/01/rdf-schema#"
  nif: "http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#"
  rdf: "http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  owl: "http://www.w3.org/2002/07/owl#"
  mesh: "http://id.nlm.nih.gov/mesh/"
  obo: "http://purl.obolibrary.org/obo/"
  org: "http://www.w3.org/ns/org#"
  cito: "http://purl.org/spar/cito/"
  datacite: "http://purl.org/spar/datacite/"
  geo: "http://www.w3.org/2003/01/geo/wgs84_pos#"
  ror: "https://ror.org/vocab#"
  skos: "http://www.w3.org/2004/02/skos/core#"
  pyeuropepmc: "https://w3id.org/pyeuropepmc/vocab#"

# Base URI for generated data URIs (fallback URIs when no external identifiers available)
_base_uri: "https://w3id.org/pyeuropepmc/"

# Knowledge Graph Structure Configuration
# Controls how entities are organized in RDF graphs
_kg_structure:
  # Default behavior for including content entities (sections, references, tables, figures)
  # Set to false for metadata-only graphs, true for complete graphs
  include_content: true
  # Default KG type: "complete" (all entities), "metadata" (papers/authors/institutions only), "content" (sections/references/tables/figures only)
  default_type: "complete"
  # Enable semantic networks by default
  enable_citation_networks: true
  enable_collaboration_networks: true
  enable_institutional_hierarchies: true
  enable_quality_metrics: true
  enable_shacl_validation: false
  # Quality scoring thresholds
  quality_thresholds:
    high: 0.8
    medium: 0.6
    low: 0.0

# Named Graphs Configuration
# Defines the structure and organization of named graphs for enhanced RDF
_named_graphs:
  authors:
    title: "Author Entities and Relationships"
    description: "Contains all author entities, their affiliations, collaborations, and quality metrics"
    uri_base: "https://w3id.org/pyeuropepmc#authors"
    enabled: true
  institutions:
    title: "Institutional Entities and Hierarchies"
    description: "Contains institutional entities, hierarchies, and organizational relationships"
    uri_base: "https://w3id.org/pyeuropepmc#institutions"
    enabled: true
  publications:
    title: "Publication Entities and Citations"
    description: "Contains publication entities, citation networks, and bibliographic relationships"
    uri_base: "https://w3id.org/pyeuropepmc#publications"
    enabled: true
  provenance:
    title: "Provenance and Quality Metrics"
    description: "Contains provenance information, quality scores, and temporal metadata"
    uri_base: "https://w3id.org/pyeuropepmc#provenance"
    enabled: true

# ScholarlyWorkEntity mapping (base class)
ScholarlyWorkEntity:
  rdf:type: ["bibo:Document"]
  fields:
    title: dcterms:title
    doi: bibo:doi
    volume: bibo:volume
    pages: bibo:pages
    publication_year: dcterms:issued  # More specific than dcterms:issued for year
    publication_date: dcterms:date    # Full date gets dcterms:date
    pmcid: dcterms:identifier
    pmid: bibo:pmid
    semantic_scholar_id: pyeuropepmc:semanticScholarId
  # Multi-value fields (authors handled as relationships in subclasses)
  multi_value_fields: {}

# PaperEntity mapping
PaperEntity:
  rdf:type: ["bibo:AcademicArticle"]
  fields:
    issue: bibo:issue
    pub_date: dcterms:issued  # Legacy field, use dcterms:issued for consistency
    abstract: dcterms:abstract
    citation_count: pyeuropepmc:citationCount  # Use CiTO ontology for citations
    influential_citation_count: pyeuropepmc:influentialCitationCount
    is_oa: dcterms:accessRights
    oa_status: dcterms:accessRights
    oa_url: bibo:uri
    reference_count: bibo:numPages
    cited_by_count: pyeuropepmc:citationCount
    publisher: dcterms:publisher  # Use dcterms:publisher instead of bibo:publisher for consistency
    issn: bibo:issn
    publication_type: bibo:DocumentType
    first_page: bibo:pageStart
    last_page: bibo:pageEnd
    semantic_scholar_corpus_id: pyeuropepmc:semanticScholarCorpusId
    openalex_id: pyeuropepmc:openAlexId
  # Multi-value fields (lists)
  multi_value_fields:
    keywords: dcterms:subject
    fields_of_study: dcterms:subject
    funders: foaf:fundedBy  # Use FOAF vocabulary for funding relationships
    related_works: dcterms:related
  # Relationships
  relationships:
    authors:
      predicate: dcterms:creator
      inverse: foaf:made
    journal:
      predicate: bibo:journal
      inverse: bibo:article
    sections:
      predicate: dcterms:hasPart
      inverse: dcterms:isPartOf
    references:
      predicate: cito:cites
      inverse: cito:isCitedBy
    tables:
      predicate: dcterms:hasPart
      inverse: dcterms:isPartOf

# AuthorEntity mapping
AuthorEntity:
  rdf:type: ["foaf:Person"]
  fields:
    full_name: foaf:name
    first_name: foaf:givenName
    last_name: foaf:familyName
    initials: foaf:initials
    orcid: foaf:account
    openalex_id: pyeuropepmc:openAlexAuthorId
    semantic_scholar_id: datacite:semanticScholarId
    affiliation_text: org:memberOf
    position: org:role
    email: foaf:mbox
  # Multi-value fields
  multi_value_fields:
    sources: prov:hadPrimarySource
  # Relationships
  relationships:
    papers:
      predicate: foaf:made
      inverse: dcterms:creator
    institutions:
      predicate: org:memberOf
      inverse: org:hasMember

# SectionEntity mapping
SectionEntity:
  rdf:type: ["bibo:DocumentPart", "nif:Context"]
  fields:
    title: dcterms:title
    content: nif:isString
    begin_index: nif:beginIndex
    end_index: nif:endIndex
  # Relationships
  relationships:
    paper:
      predicate: dcterms:isPartOf
      inverse: dcterms:hasPart
    subsections:
      predicate: dcterms:hasPart
      inverse: dcterms:isPartOf  # TODO: Implement SubsectionEntity or remove if not needed

# TableEntity mapping
TableEntity:
  rdf:type: ["bibo:Table"]
  fields:
    caption: dcterms:description
    table_label: rdfs:label
  # Relationships
  relationships:
    paper:
      predicate: dcterms:isPartOf
      inverse: dcterms:hasPart
    rows:
      predicate: dcterms:hasPart
      inverse: dcterms:isPartOf

# TableRowEntity mapping
TableRowEntity:
  rdf:type: ["bibo:Row"]
  fields:
    headers: rdfs:label  # Changed from multi_value_fields (headers are typically single string per row)
  multi_value_fields:
    cells: rdfs:member
  # Relationships
  relationships:
    table:
      predicate: dcterms:isPartOf
      inverse: dcterms:hasPart

# ReferenceEntity mapping
ReferenceEntity:
  rdf:type: ["bibo:Article"]  # More specific than bibo:Document
  # Inherits all fields from ScholarlyWorkEntity
  # No additional fields specific to references
  # Relationships
  relationships:
    citing_paper:
      predicate: cito:isCitedBy
      inverse: cito:cites

# InstitutionEntity mapping
InstitutionEntity:
  rdf:type: ["org:Organization"]
  fields:
    display_name: skos:prefLabel
    ror_id: pyeuropepmc:rorId
    openalex_id: pyeuropepmc:openAlexInstitutionId
    country: geo:country
    country_code: geo:countryCode
    city: geo:city
    latitude: geo:lat
    longitude: geo:long
    institution_type: org:classification
    grid_id: pyeuropepmc:gridId
    isni: pyeuropepmc:isni
    wikidata_id: owl:sameAs
    fundref_id: pyeuropepmc:fundrefId
    website: foaf:homepage
    established: dcterms:created
  # Multi-value fields
  multi_value_fields:
    domains: dcterms:subject
  # Relationships
  relationships:
    members:
      predicate: org:hasMember
      inverse: org:memberOf

# JournalEntity mapping
JournalEntity:
  rdf:type: ["bibo:Journal"]
  fields:
    title: dcterms:title
    medline_abbreviation: bibo:shortTitle
    iso_abbreviation: bibo:shortTitle
    nlmid: bibo:nlmid
    issn: bibo:issn
    essn: bibo:eissn
    publisher: dcterms:publisher
    country: geo:country
    language: dcterms:language
    journal_issue_id: bibo:issue
    openalex_id: datacite:openAlexId
    wikidata_id: owl:sameAs
    scopus_source_id: pyeuropepmc:scopusSourceId
    impact_factor: pyeuropepmc:impactFactor
    sjr: pyeuropepmc:sjr
    h_index: pyeuropepmc:hIndex
  # Multi-value fields
  multi_value_fields:
    subject_areas: dcterms:subject
  # Relationships
  relationships:
    papers:
      predicate: bibo:article
      inverse: bibo:journal
